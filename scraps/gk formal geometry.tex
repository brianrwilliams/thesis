\documentclass[10pt]{amsart}

\usepackage{macros,slashed}

\linespread{1.25}

\title{Gelfand-Kazhdan formal geometry}

\def\brian{\textcolor{blue}{BW: }\textcolor{blue}}

\begin{document}
\maketitle

\section{Gelfand-Kazhdan formal geometry}

In this section we review the theory of Gelfand-Kazhdan formal geometry and its use in natural constructions in differential geometry,
organized in a manner somewhat different from the standard
approaches. We emphasize the role of the frame bundle and jet bundles.
We conclude with a treatment of the Atiyah class, which may be our only novel addition (although unsurprising) to the formalism.

We remark that from hereon we will work with complex manifolds and holomorphic vector bundles.
 
\subsection{A Harish-Chandra pair for the formal disk}

Let $\hO_n$ denote the algebra of formal power series 
\ben
\CC [[ t_1,\ldots,t_n ]],
\een 
which we view as ``functions on the formal $n$-disk $\hD^n$.'' 
It is filtered by powers of the maximal ideal $\fm_n = (t_1,\ldots,t_n)$, and it is the limit of the sequence of artinian algebras
\[
\cdots \to \hO_n/(t_1,\ldots,t_n)^k \to \cdots \hO_n/(t_1,\ldots,t_n)^2 \to \hO_n/(t_1,\ldots,t_n) \cong \CC.
\] 
One can use the associated adic topology to interpret many of our constructions, but we will not emphasize that perspective here.

We use $\Vect$ to denote the Lie algebra of derivations of $\hO_n$, which consists of first-order differential operators with formal power series coefficients:
\[
\Vect = \left\{ \sum_{i =1 }^n f_i \frac{\partial}{\partial t_i} \,:\, f_i \in \hO_n\right\}.
\]
The group $\GL_n$ also acts naturally on $\hO_n$: for $M \in \GL_n$ and $f \in \hO_n$,
\[
(M \cdot f)(t) = f (Mt),
\]
where on the right side we view $t$ as an element of $\CC^n$ and let $M$ act linearly.
In other words, we interpret $\GL_n$ as acting ``by diffeomorphisms'' on $\hD^n$ and then use the induced pullback action on functions on $\hD^n$.
The actions of both $\Vect$ and $\GL_n$ intertwine with multiplication of power series, 
since ``the pullback of a product of functions equals the product of the pullbacks.''

\subsubsection{Formal automorphisms}

Let $\Aut_n$ be the group of filtration-preserving automorphisms of the algebra $\hO_n$,
which we will see is a pro-algebraic group.
Explicitly, such an automorphism $\phi$ is a map of algebras that preserves the maximal ideal, 
so $\phi$ is specified by where it sends the generators $t_1$, \dots, $t_n$ of the algebra.
In other words, each $\phi \in \Aut_n$ consists of an $n$-tuple $(\phi_1,\ldots,\phi_n)$ 
such that each $\phi_i$ is in the maximal ideal generated by $(t_1,\ldots,t_n)$ and such that there exists an $n$-tuple $(\psi_1,\ldots,\psi_n)$ 
where the composite
\[
\psi_j(\phi_1(t),\ldots,\phi_n(t)) = t_j
\]
for every $j$ (and likewise with $\psi$ and $\phi$ reversed).
This second condition can be replaced by verifying that the Jacobian matrix
\[
Jac(\phi) = (\partial \phi_i/\partial t_j) \in {\rm Mat}_n(\hO_n)
\]
is invertible over $\hO_n$, by a version of the inverse function theorem.

Note that this group is far from being finite-dimensional, so it does not fit immediately into the setting of HC-pairs described above. 
It is, however, a {\em pro}-Lie group in the following way. 
As each $\phi \in \Aut_n$ preserves the filtration on $\hO_n$, it induces an automorphism of each partial quotient $\hO_n/\fm_n^k$.
Let $\Aut_{n,k}$ denote the image of $\Aut_n$ in $\Aut(\hO_n/\fm_n^k)$; this group $\Aut_{n,k}$ is clearly a quotient of $\Aut_n$.
Note, for instance, that $\Aut_{n,1} = \GL_n$.
Explicitly, an element $\phi$ of ${\rm Aut}_{n,k}$ is the collection of $n$-tuples $(\phi_1,\ldots,\phi_n)$ 
such that each $\phi_i$ is an element of $\fm_n/\fm_n^k$ and such that the Jacobian matrix $Jac(\phi)$ is invertible in $\hO_n/\fm_n^k$.
The group ${\rm Aut}_{n,k}$ is manifestly a finite dimensional Lie group, as the quotient algebra is a finite-dimensional vector space. 
 
The group of automorphisms $\Aut_n$ is the pro-Lie group associated with the natural sequence of Lie groups
\ben
\cdots \to \Aut_{n,k} \to \Aut_{n,k-1} \to \cdots \to \Aut_{n,1} = \GL_n.
\een
Let $\Aut_n^+$ denote the kernel of the map $\Aut_n \to \GL_n$ so that we have a short exact sequence
\ben
1 \to \Aut_n^+ \to \Aut_n \to \GL_n \to 1 .
\een
In other words, for an element $\phi$ of $\Aut_n^+$, each component
$\phi_i$ is of the form $t_i + \cO(t^2)$. The group $\Aut_n^+$ is
pro-nilpotent, hence contractible. 

The Lie algebra of $\Aut_n$ is {\em not} the Lie algebra of formal
vector fields $\Vect$. A direct
calculation shows that the Lie algebra of $\Aut_n$ is the Lie algebra $\Vectz \subset \Vect$ of formal vector fields with zero constant coefficient (i.e., that vanish at the origin of $\hD^n$). 

Observe that the group $\GL_n$ acts on the Lie algebra $\Vect$ by the obvious linear ``changes of frame.''
The Lie algebra $\Lie({\GL_n}) = \fgl_n$ sits inside $\Vect$ as the linear vector fields
\ben
\left\{\sum_{i,j} a^j_i t_i \frac{\partial}{\partial t_j} \; : \; a^{i}_j \in \CC \right\}.
\een 
We record these compatibilities in the following statement.

\begin{lem} 
The pair $(\Vect, \GL_n)$ form a Harish-Chandra pair.
\end{lem}
\begin{proof} The only thing to check is that the differential of the
  action of $\GL_n$ corresponds with the adjoint action of $\fgl_n
  \subset \Vect$ on formal vector fields. This is by construction. 
\end{proof}

\subsection{The coordinate bundle}

In this section we review the central object in the Gelfand-Kazhdan
picture of formal geometry: the coordinate bundle.

%Our version of Harish-Chandra localization is intimately related to, and motivated by, the methods of formal geometry developed by Gelfand, Fuchs, Kazhdan, and many others \brian{refs}. 
%It has been used prominently in the setting of deformation quantization, notably by Kontsevich \brian{ref}, Nest-Tsygan \brian{ref}, Cattaneo-Felder \brian{ref}, and \brian{more}. 
%Here we start by reviewing the big picture before delving into some precise definitions and summarizing the relevant results from the literature.

\subsubsection{}

Given a complex manifold, its {\em coordinate space} $X^{coor}$ is the (infinite-dimensional) space parametrizing jets of holomorphic coordinates of $X$. 
(It is a pro-complex manifold, as we'll see.) 
Explicitly, a point in $X^{coor}$ consists of a point $x \in X$ 
together with an $\infty$-jet class of a local biholomorphism $\phi : U \subset \CC^n \to X$ 
sending a neighborhood $U$ of the origin to a neighborhood of $x$ such that $\phi(0) = x$. 

There is a canonical projection map $\pi^{coor} : X^{coor} \to X$ by remembering only the underlying point in $X$. 
The group $\Aut_n$ acts on $X^{coor}$ by ``change of coordinates," 
i.e., by precomposing a local biholomorphism $\phi$ with an automorphism of the disk around the origin in $\CC^n$.
This action identifies $\pi^{coor}$ as a principal bundle for the pro-Lie group $\Aut_n$. 

One way to formalize these ideas is to realize $X^{coor}$ as a limit of finite-dimensional complex manifolds. 
Let $X_k^{coor}$ be the space consisting of points $(x, [\phi]_k)$, 
where $\phi$ is a local biholomorphism as above and $[-]_k$ denotes taking its $k$-jet equivalence class. 
Let $\pi_k^{coor} : X^{coor}_k \to X$ be the projection. 
By construction, the finite-dimensional Lie group $\Aut_{n,k}$ acts on the fibers of the projection freely and transitively 
so that $\pi_k^{coor}$ is a principal $\Aut_{n,k}$-bundle. The bundle $X^{coor} \to X$ is the limit of the sequence of principal bundles on X
\ben
\xymatrix{
\cdots \ar[r] & X^{coor}_k \ar[r] \ar[drrrr]_-{\pi_k^{coor}} & X^{coor}_{k-1} \ar[drrr]^-{\pi_{k-1}^{coor}} \ar[r] & \cdots \ar[r] & X_2^{coor} \ar[dr]^{\pi_2^{coor}} \ar[r] & X_1^{coor} \ar[d]^-{\pi_1^{coor}} \\ 
 & & & & & X .
}
\een

In particular, note that the $\GL_n = \Aut_{n,1}$-bundle $\pi_1^{coor} : X^{coor}_1 \to X$ is the frame bundle
\ben
\pi^{fr} : {\rm Fr}_X \to X,
\een
i.e., the principal bundle associated to the tangent bundle of $X$.

\subsubsection{The Grothendieck connection} 

We can also realize the Lie algebra $\Vect$ as an inverse limit. 
Recall the filtration on $\Vect$ by powers of the maximal ideal $\fm_n$ of $\hO_n$. 
Let ${\rm W}_{n,k}$ denote the quotient $\Vect / \fm_n^{k+1} \Vect$. 
For instance, ${\rm W}_{n,1} = \mathfrak{aff}_n = \CC^n \ltimes \fgl_n$, the Lie algebra of affine transformations of $\CC^n$. We have $\Vect = \lim_{k \to \infty} {\rm W}_{n,k}$. 

The Lie algebra of $\Aut_{n,k}$ is
\[
{\rm W}_{n,k}^0 := \fm_n \cdot \Vect /\fm_n^{k+1} \Vectz .
\]
That is, the Lie algebra of vector fields vanishing at zero modulo the $k+1$ power of the maximal ideal. Thus, the principal $\Aut_{n,k}$-bundle $X_{k}^{coor} \to X$ induces an exact sequence of tangent spaces
\ben
{\rm W}_{n,k}^0 \to T_{(x,[\varphi]_k)}X^{coor} \to T_x X;
\een
by using $\varphi$, we obtain a canonical isomorphism of tangent spaces $\CC^n \cong T_0 \CC^n \cong T_x X$. Combining these observations, we obtain an isomorphism
\ben
{\rm W}_{n,k} \cong T_{(x,[\varphi]_k)} X^{coor}_k .
\een
In the limit $k \to \infty$ we obtain an isomorphism $\Vect \cong T_{(x,[\varphi]_\infty)} X^{coor}$. 

\begin{prop}[Section 5 of \cite{NT}, Section 3 of \cite{CF2}]
There exists a canonical action of $\Vect$ on $X^{coor}$ by
holomorphic vector fields, i.e., there is a Lie algebra homomorphism
\ben
\theta : \Vect \to \cX^{hol}(X^{coor}) .
\een
Moreover, this action induces the isomorphism $\Vect \cong
T_{(x,[\phi]_\infty)} X^{coor}$ at each point.
\end{prop}

\noindent Here, $\cX(X^{coor})$ is understood as the inverse limit of the finite-dimensional Lie algebras $\cX(X^{coor}_k)$.

The inverse of the map $\theta$ provides a connection one-form
\ben
\omega^{coor} \in \Omega^1_{hol}(X^{coor}; \Vect),
\een
which we call the {\em universal Grothendieck connection} on $X$. 
As $\theta$ is a Lie algebra homomorphism, $\omega^{coor}$ satisfies the Maurer-Cartan equation
\be\label{mc}
\partial \omega^{coor} + \frac{1}{2} [\omega^{coor},\omega^{coor}] = 0 .
\ee
Note that the proposition ensures that this connection is universal on all complex manifolds of dimension $n$ 
and indeed pulls back along local biholomorphisms.

\begin{rmk} 
Both the pair $(\Vect, \Aut)$ and the bundle $X^{coor} \to X$ together
with $\omega^{coor}$ do not fit in our model for general
Harish-Chandra descent above. 
They are, however, objects in a larger category of pro-Harish-Chandra pairs and pro-Harish-Chandra bundles, respectively. 
We do not develop this theory here, but it is inherent in the work of
\cite{BK}.  
Indeed, by working with well-behaved representations for the pair $(\Vect,\Aut)$, 
Gelfand, Kazhdan, and others use this universal construction to produce many of the natural constructions in differential geometry.
As we remarked earlier, it is a kind of refinement of tensor calculus.
\end{rmk}

\subsubsection{A Harish-Chandra structure on the frame bundle}

\def\Sect{{\rm Sect}}
\def\Fr{{\rm Fr}}
\def\Exp{{\rm Exp}}

Although the existence of the coordinate bundle
$X^{coor}$ is necessary in the remainder of this paper, it is convenient for us to use it in a rather
indirect way. Rather, we will work with the frame bundle ${\rm Fr}_X \to X$ equipped with the structure of a module for the Harish-Chandra pair $(\Vect, \GL_n)$. 
The $\Vect$-valued connection on $\Fr_X$ is induced from the Grothendieck connection above.

\begin{dfn}\label{fmlexp} 
Let $\Exp (X)$ denote the quotient $X^{coor} / \GL_n$. 
A holomorphic section of $\Exp(X)$ over $X$ is called a {\em formal exponential}. 
\end{dfn}

\begin{rmk} 
The space $\Exp(X)$ can be equipped with the structure of a principal $\Aut_n^+$-bundle over $X$.
This structure on $\Exp(X)$ depends on a choice of a section of the short exact sequence
\ben
1 \to \Aut_n^+ \to \Aut_n \to \GL_n \to 1 .
\een
It is natural to use the splitting determined by the choice of coordinates on the formal disk.
\end{rmk}

Note that $\Aut_n^+$ is contractible, and so sections always exist. 
A formal exponential is useful because it equips the frame bundle with a $(\Vect,\GL_n)$-module structure, as follows.

%The space of formal exponentials is the (infinite dimensional) affine space $\Sect_X(\Exp_X^\infty)$. Unraveling the definition, such a section $\sigma$ of $X^{aff}$ is an $\infty$-jet equivalence class of a local diffeomorphism
%\ben
%\sigma_x : T_x X \to X
%\een
%for each $x \in X$ such that
%\begin{itemize}
%\item[(i)] $\sigma_x(0) = x$
%\item[(ii)]\label{exp2} The derivative at $0$ of $\sigma_x$ is the identity $D (\sigma)_0 = {\rm id} : T_x X \to T_x X$. 
%\end{itemize}
% 
%\begin{rmk} In \brian{Cattaneo-Felder, more} this bundle is denoted $X^{aff} \to X$ and is called the affine bundle. 
%\end{rmk}

\begin{prop} \label{gauge equiv}
A formal exponential $\sigma$ pulls back to a $\GL_n$-equivariant map $\tilde{\sigma} : \Fr_X \to X^{coor}$,
and hence equips $(\Fr_x, \sigma^* \omega^{coor})$ with the structure
of a principal $(\Vect,\GL_n)$-bundle with flat connection.
Moreover, any two choices of formal exponential determine $(\Vect,\GL_n)$-structures on $X$ that are gauge-equivalent. 
\end{prop}

For a full proof, see \cite{NT}, \cite{nest1995}, or \cite{khors} but the basic idea is easy to explain.

\begin{proof}[Sketch of proof]
The first assertion is tautological, since the data of a section is equivalent to such an equivariant map, but we explicate the underlying geometry.
A map $\rho : \Fr_X \to X^{coor}$ assigns to each pair  $(x, \mathbf{y}) \in \Fr_X$,
with $x \in X$ and $\mathbf{y} : \CC^n \xto{\cong} T_x X$ a linear frame,
an $\infty$-jet of a biholomorphism $\phi: \CC^n \to X$ such that $\phi(0) = x$ and $D\phi(0) = \mathbf{y}$.
Being $\GL_n$-equivariant ensures that these biholomorphisms are related by linear changes of coordinates on $\CC^n$.
In other words, a $\GL_n$-equivariant map $\tilde{\sigma}$ describes how each frame on $T_x X$ exponentiates to a formal coordinate system around $x$,
and so the associated section $\sigma$ assigns a formal exponential map $\sigma(x) \colon T_x X \to X$ to each point $x$ in $X$.
(Here we see the origin of the name ``formal exponential.'')

The second assertion would be immediate if $X^{coor}$ were a complex manifold, since the flat bundle structure would pull back,
so all issues are about carefully working with pro-manifolds.

The final assertion is also straightforward: the space of sections is contractible since $\Aut_n^+$ is contractible, 
so one can produce an explicit gauge equivalence.
\end{proof}

% \owen{Explain that a connection on the tangent bundle produces local exponential maps and hence a formal exponential,
% an observation that Willwacher refines.}

% In practice, formal exponentials are easy to produce. Consider a connection on the holomorphic tangent bundle. \brian{finish this}

\begin{rmk} 
In \cite{willwacher} Willwacher provides a description of the space $\Exp(X)$ of {\em all} formal exponentials. He shows that it is isomorphic to the space of pairs $(\nabla_0, \Phi)$
where $\nabla_0$ is a torsion-free connection on $X$ for $T_X$ and $\Phi$ is a section of the bundle
\ben
\Fr_X \times_{\GL_n} {\rm W}_n^3
\een
where ${\rm W}_n^3 \subset \Vect$ is the subspace of formal vector fields whose coefficients are at least cubic. 
In particular, every torsion-free affine connection determines a formal exponential. The familiar case above that produces a formal coordinate from a connection corresponds to choosing the zero vector field. 
\end{rmk}

%Given a formal exponential $\sigma$ we now construct a formal vector field valued connection one-form $\omega^\sigma \in \Omega^1(\Fr_X; \Vect)$ satisfying the Maurer-Cartan equation. Hence, a $(\Vect,\GL_n)$-structure on $\Fr_X$. 
%
%Let $(x, \mathbf{y}) \in \Fr_X$. Define $\omega^\sigma_{(x, \mathbf{y})} : T_{(x, \mathbf{y})} \Fr_X \to \Vect$
%as the composition 
%\ben
%\xymatrix{
%T_{(x, \mathbf{y})} \Fr_X \ar[r]^-{D \sigma} & T_{(x, \sigma(\mathbf{y}))} X^{coor} \ar[r]^-{\omega^{coor}} & \Vect .
%}
%\een 
%This defines $\omega^\sigma \in \Omega^1(\Fr_X; \Vect)$. The fact that $\omega^\sigma$ is $\GL_n$-invariant follows from the fact that $D \sigma|_0$ is the identity. 
%
%\brian{MC equation, gauge equivalence for different choices of splitting}

\begin{dfn}
A {\em Gelfand-Kazhdan structure} on the frame bundle $\Fr_X\to X$ of a complex manifold $X$ of dimension $n$ is a formal exponential $\sigma$, 
which makes $\Fr_X$ into a flat $(\Vect,\GL_n)$-bundle with connection one-form $\omega^\sigma$, 
the pullback of $\omega^{coor}$ along the $\GL_n$-equivariant lift $\tilde{\sigma} : \Fr_X \to X^{coor}$.
\end{dfn}

\begin{eg} 
Consider the case of an open subset $U \subset \CC^n$. 
There are thus natural holomorphic coordinates $\{z_1,\ldots,z_n\}$ on $U$. 
These coordinates provides a natural choice of a formal exponential. 
Moreover, with respect to the isomorphism
\ben
\Omega^1_{hol}(\Fr_U ; \Vect)^{\GL_n} \cong \Omega^1_{hol}(U ; \Vect),
\een
we find that the connection 1-form has the form
\ben
\omega^{coor} = \sum_{i=1}^n \d z_i \tensor \frac{\partial}{\partial t_i},
\een 
where the $\{t_i\}$ are the coordinates on the formal disk $\hD^n$.
\end{eg} 

A Gelfand-Kazhdan structure allows us to apply a version of Harish-Chandra descent, which will be a central tool in our work.

Although we developed Harish-Chandra descent on all flat $(\fg,K)$-bundles, 
it is natural here to restrict our attention to manifolds of the same dimension,
as the notions of coordinate and affine bundle are dimension-dependent.
Hence we replace the underlying category of all complex manifolds by a more restrictive setting.

\begin{dfn}
Let $\Hol_n$ denote the category whose objects are complex manifolds of dimension $n$ and whose morphisms are local biholomorphisms.
In other words, a map $f: X \to Y$ in $\Hol_n$ is a map of complex manifolds such that each point $x \in X$ admits a neighborhood $U$ on which $f|_U$ is biholomorphic with $f(U)$.
\end{dfn}

There is a natural inclusion functor $i : \Hol_n \to {\rm CplxMan}$ (not fully faithful) and the frame bundle $\Fr$ defines a section of the fibered category $i^*\VB$,
since the frame bundle pulls back along local biholomorphisms.
For similar reasons, the coordinate bundle is a pro-object in $i^*\VB$.

\begin{dfn}
Let $\GK_n$ denote the category fibered over $\Hol_n$ whose objects are a Gelfand-Kazhdan structure 
--- that is, a pair $(X, \sigma)$ of a complex $n$-manifold and a formal exponential ---
and whose morphisms are simply local biholomorphisms between the underlying manifolds.
\end{dfn}

Note that the projection functor from $\GK_n$ to $\Hol_n$ is an equivalence of categories, since the space of formal exponentials is affine.

\subsection{The category of formal vector bundles}

For most of our purposes, it is convenient and sufficient to work with a small category of $(\Vect,\GL_n)$-modules 
that is manifestly well-behaved and whose localizations appear throughout geometry in other guises, 
notably as $\infty$-jet bundles of vector bundles on complex manifolds.
(Although it would undoubtedly be useful, we will not develop here the general theory of modules for the Harish-Chandra pair $(\Vect,\GL_n)$, 
which would involve subtleties of pro-Lie algebras and their representations.)

We first start by describing the category of $(\Vect, \GL_n)$-modules
that correspond to modules over the structure sheaf of a manifold. Note that $\hO_n$ is the quintessential example of a commutative algebra object in the symmetric monoidal category of $(\Vect,\GL_n)$-modules, 
for any natural version of such a category. We consider modules that
have actions of both the pair and the algebra $\hO_n$ with obvious
compatibility restrictions. 

\begin{dfn} A {\em formal $\hO_n$-module} is a
  vector space $\cV$ equipped with
\begin{itemize}
\item[(i)] the structure of a $(\Vect, \GL_n)$-module;
\item[(ii)] the structure of a $\hO_n$-module;
\end{itemize}
such that 
\begin{itemize}
\item[(1)] for all $X \in \Vect$, $f \in \hO_n$ and $v \in \cV$ we
  have $X(f \cdot v) = X(f) \cdot v + f \cdot (X \cdot v)$;
\item[(2)] for all $A \in \GL_n$ we have $A (f \cdot v) = (A \cdot f) \cdot (A \cdot v)$,  where $A$ acts on $f$ by a linear change of frame.
\end{itemize}
A morphism of formal $\hO_n$-modules is a $\hO_n$-linear map of
$(\Vect, \GL_n)$-modules $f : \cV \to \cV'$. We denote this category
by $\Mod_{(\Vect, \GL_n)}^{\cO_n}$. 
\end{dfn}

Just as the category of $D$-modules is symmetric monoidal via tensor over $\cO$, we have the following result.

\begin{lem}
The category $\Mod^{\cO_n}_{(\Vect, \GL_n)}$ is symmetric monoidal with respect to tensor over $\hO_n$.
\end{lem} 

\begin{proof}
The category of $\hO_n$-modules is clearly symmetric monoidal by tensoring over $\hO_n$. We simply need to verify that the Harish-Chandra module structures extend in a natural way, but this is clear.
\end{proof}

We will often restrict ourselves to considering Harish-Chandra modules as above that are free as underlying $\hO_n$-modules. 
Indeed, let
\ben
\VB_n \subset \Mod_{(\Vect, \GL_n)}^{\cO_n}
\een
be the full subcategory spanned by objects that are free and finitely generated as underlying $\hO_n$-modules. 
Upon descent these will correspond to ordinary vector bundles and so
we refer to this category as {\em formal vector bundles}. 

The category of formal $\hO_n$-modules has a natural symmetric monoidal structure by tensor product over $\hO$. The Harish-Chandra action is extended by
\[
X \cdot (s \otimes t) = (X s) \otimes t + s \otimes (Xt). 
\]
This should not look surprising; it is the same formula for tensoring
$D$-modules over $\cO$. 

The internal hom $\Hom_{\hO}(\cV,\cW)$ also provides a vector bundle on the formal disk, 
where the Harish-Chandra action is extended by
\[
(X \cdot \phi)(v) = X \cdot (\phi(v)) - \phi(X\cdot v). 
\]

Observe that for any $D$-module $M$, we have an isomorphism
\[
\Hom_{D}(\hO, M) \cong \Hom_{\Vect}(\CC, M)
\]
since a map of $\hD$-modules out of $\hO$ is determined by where it sends the constant function 1. 
Hence we find that there is a quasi-isomorphism 
\[
\RR\Hom_{D}(\hO, \cV) \simeq \clie^*(\Vect ; \cV),
\]
or more accurately a zig-zag of quasi-isomorphisms. Here
$\clie^*(\Vect ; \cV)$ is the continuous cohomology of $\Vect$ with
coefficients in $\cV$. This is known as the {\em Gelfand-Fuks}
cohomology of $\cV$ and is what we use for the remainder of the
paper. 

This relationship extends to the $\GL_n$-equivariant setting as well, giving us the following result.

\begin{lem}
There is a quasi-isomorphism
\[
\clie^*(\Vect,\GL_n; \cV) \simeq \RR \Hom_D(\hO,\cV)^{\GL_n-{\rm eq}},
\]
where the superscript $\GL_n-{\rm eq}$ denotes the $\GL_n$-equivariant maps.
\end{lem}

\begin{rmk}
One amusing way to understand this category is as Harish-Chandra descent to the formal $n$-disk itself. 
Consider the frame bundle $\widehat{\Fr} = \hD^n \times \GL_n \to \hD^n$ of the formal $n$-disk itself, 
which possesses a natural flat connection via the Maurer-Cartan form $\omega_{MC}$ on $\GL_n$. 
Let $\rho: \GL_n \to \GL(V)$ be a finite-dimensional representation. 
Then the subcomplex of $\Omega^*(\widehat{\Fr})\otimes V$ given by the basic forms is isomorphic to
\[
\left(\Omega^*(\hD^n) \otimes V, \d_{dR} + \rho(\omega_{MC}) \right).
\]
This equips the associated bundle $\widehat{\Fr}\times^{\GL_n} V$ with a flat connection and 
hence makes its sheaf of sections a $D$-module on the formal disk.
\end{rmk}

Many of the important $\hO_n$-modules we will consider simply come from linear tensor representations of $\GL_n$. 
Given a finite-dimensional $\GL_n$-representation $V$, we construct a $\hO_n$-module $\cV \in \VB_n$ as follows. 

Consider the decreasing filtration of $\Vect$ by vanishing order of jets 
\ben
\cdots \subset \fm^{2}_n \cdot {\rm W}_{n} \subset \fm^1_n \cdot {\rm W}_n \subset {\rm W}_n .
\een 
The induced map $\fm_n^1 \cdot \Vect \to \fm_n^1 \cdot \Vect / \fm_n^2
\cdot \Vect \cong \fgl_n$ allows us to restrict $V$ to a $\fm_n^1 \cdot
\Vect$-module. 
We  then coinduce this module along the inclusion $\fm^1 \cdot \Vect
\subset \Vect$ to get a $\Vect$-module $\cV = \Hom_{\fm_n^1 \cdot \Vect}(\Vect,V)$. 
There is an induced action of $\GL_n$ on $\cV$. Indeed, as a $\GL_n$-representation one has $\cV \cong \hO_n \tensor_{\CC} V$.
Moreover, this action is compatible with the $\Vect$-module structure, so that $\cV$ is actually a $(\Vect, \GL_n)$-module. 
Thus, the construction provides a functor  from $\Rep_{\GL_n}$ to
$\VB_n$.

\begin{dfn} 
We denote by ${\rm Tens}_n$ the image of finite-dimensional $\GL_n$-representations in $\VB_n$ along this functor. 
We call it the category of {\em formal tensor fields}.
\end{dfn}

As mentioned $\hO_n$ is an example, associated to the trivial one-dimensional $\GL_n$ representation.
Another key example is $\hT_n$, the vector fields on the formal disk, which is associated to the defining $\GL_n$ representation $\CC^n$; 
it is simply the adjoint representation of $\Vect$.
Other examples include $\hOmega^1_n$, the 1-forms on the formal disk; it
is the correct version of the coadjoint representation, and more
generally the space of $k$-forms on the formal disk $\hOmega^k_n$. 

The category ${\rm Tens}_n$ can be interpreted in two other ways, as we will see in subsequent work.
\begin{enumerate}
\item They are the $\infty$-jet bundles of tensor bundles: for a finite-dimensional $\GL_n$-representation, 
construct its associated vector bundle along the frame bundle and take its $\infty$-jets.
\item They are the flat vector bundles of finite-rank on the formal $n$-disk that are equivariant with respect to automorphisms of the disk. 
In other words, they are $\GL_n$-equivariant $D$-modules whose underlying $\hO$-module is finite-rank and free.
\end{enumerate}
It should be no surprise that given a Gelfand-Kazhdan structure on the frame bundle of a non-formal $n$-manifold $X$, 
a formal tensor field descends to the $\infty$-jet bundle of the corresponding tensor bundle on $X$. 
The flat connection on this descent bundle is, of course, the Grothendieck connection on this $\infty$-jet bundle. 
(For some discussion, see section 1.3, pages 12-14, of \cite{Fuks}.)

Note that the subcategories 
\ben
{\rm Tens}_n \hookrightarrow \VB_n
\hookrightarrow \Mod_{(\Vect, \GL_n)}^{\cO_n}
\een
inherit the symmetric monoidal structure constructed above. 

\subsection{Gelfand-Kazhdan descent}

We will focus on defining descent for the category $\VB_n$ of formal vector
bundles. 

Fix an $n$-dimensional manifold $X$.
The main result of this section is that the associated bundle construction along the frame bundle $\Fr_X$,
\[
\begin{array}{cccc}
\Fr_X \times^{\GL_n} - :&  \Rep(\GL_n)^{fin} & \to &\VB(X)\\
& V & \mapsto & \Fr_X \times^{\GL_n} V
\end{array},
\]
which builds a tensor bundle from a $\GL_n$ representation, arises from Harish-Chandra descent for $(\Vect,\GL_n)$. 
This result allows us to equip tensor bundles with interesting structures (e.g., a vertex algebra structure) by working $(\Vect,\GL_n)$-equivariantly on the formal $n$-disk.
In other words, it reduces the problem of making a universal
construction on all $n$-manifolds to the problem of making an
equivariant construction on the formal $n$-disk,
since the descent procedure automates extension from the formal to the global.

Note that every formal vector bundle $\cV \in \WGLCAT$ is naturally filtered via a filtration inherited from $\hO_n$. 
Explicitly, we see that $\cV$ is the limit of the sequence of finite-dimensional vector spaces
\[
\cdots \to \hO_n/\fm_n^k \otimes V \to \cdots \to \hO_n/\fm_n \otimes V \cong V
\]
where $V$ is the underlying $\GL_n$-representation.
Each quotient $\hO_n/\fm_n^k \otimes V$ is a module over $\Aut_{n,k}$, and 
hence determines a vector bundle on $X$ by the associated bundle construction along $X^{coor}_k$.
In this way, $\cV$ produces a natural sequence of vector bundles on $X$ and thus a pro-vector bundle on $X$.

Given a formal exponential $\sigma$ on $X$, we obtain a $\GL_n$-equivariant map from $\Fr_X$ to $X^{coor}_k$ for every $k$,
by composing the projection map $X^{coor} \to X_k^{coor}$ with the $\GL_n$-equivariant map from $\Fr_X$ to $X^{coor}$.

\begin{dfn}
{\em Gelfand-Kazhdan descent} is the functor
\[
\desc_\GK: \GK_n^\op \times \WGLCAT \to \Pro(\VB)_{flat}
\]
sending $(\Fr_X,\sigma)$ --- a frame bundle with formal exponential
--- and a formal vector bundle $\cV$ 
to the pro-vector bundle $\Fr_X \times^{\GL_n} \cV$ with flat connection induced by the Grothendieck connection.
\end{dfn}

This functor is, in essence, Harish-Chandra descent, but in a slightly exotic context.
It has several nice properties.

\begin{lem}\label{prop lax}
For any choice of Gelfand-Kazhdan structure $(\Fr_X,\sigma)$, the descent functor $\desc_\GK((\Fr_X,\sigma),-)$ is lax symmetric monoidal.
\end{lem}

\begin{proof}
For every $\cV,\cW$ in $\WGLCAT$, we have natural maps
\[
(\Omega^*(\Fr_X) \otimes \cV)_{basic} \otimes (\Omega^*(\Fr_X) \otimes \cW)_{basic} \to (\Omega^*(\Fr_X) \otimes (\cV \otimes \cW))_{basic} \to (\Omega^*(\Fr_X) \otimes (\cV \otimes_{\hO_n} \cW))_{basic}
\]
and the composition provides the natural transformation producing the lax symmetric monoidal structure.
\end{proof}

In particular, we observe that the de Rham complex of $\desc_\GK((\Fr_X,\sigma),\hO_n)$ is a commutative algebra object in $\Omega^*(X)$-modules. 
As every object of $\WGLCAT$ is an $\hO_n$-module and the morphisms are $\hO_n$-linear, 
we find that descent actually factors through the category of $\desc_\GK((\Fr_X,\sigma),\hO_n)$-modules. 
In sum, we have the following.

\begin{lem}
The descent functor $\desc_\GK((\Fr_X,\sigma),-)$ factors as a composite
\[
\VB_n \xto{\widetilde{\desc}_\GK((\Fr_X,\sigma),-)} \Mod_{\desc_\GK((\Fr_X,\sigma),\hO_n)} \xto{\txt{forget}} \VB_{flat}(X)
\]
and the functor $\widetilde{\desc}_\GK((\Fr_X,\sigma),-)$ is symmetric monoidal.
\end{lem}

As before, we let $\sdesc_{\GK}$ denote the associated local system
obtained from $\desc_{\GK}$ by taking horizontal sections. This
functor is well-known: it recovers the tensor bundles on $X$.

If $E \to X$ is a holomorphic vector bundle on $X$ we denote by
$J_{hol}^\infty(E)$ the holomorphic $\infty$-jet bundle of $E$. If
$E_0$ is the fiber of $E$ over a point $x \in X$, then the fiber of
this pro-vector bundle over $x$ can be identified with
\ben
J_{hol}^\infty (E)|_{x} \cong E_0 \times \CC [[ t_1,\ldots,t_n]] .
\een
This pro-vector bundle has a canonical flat connection.

\begin{prop}
For $\cV \in \VB_n$ corresponding to the $\GL_n$-representation $V$,
there is a natural isomorphism of flat pro-vector bundles
\[
\desc_\GK((\Fr(X),\omega^\sigma),\cV) \cong J_{hol}^\infty(\Fr_X
\times^{\GL_n} V)
\]
In other words, the functor of descent along the frame bundle is
naturally isomorphic to the functor of taking $\infty$-jets of the associated bundle construction.
\end{prop} 

As a corollary, we see that the associated sheaf of flat sections is
\ben
\sdesc_{\GK}(\omega^\sigma, \cV) \cong \Gamma_{hol}(\Fr_X
\times^{\GL_n} V)
\een
where $\Gamma_{hol}(-)$ denotes the space of holomorphic sections. 

In other words, Gelfand-Kazhdan descent produces every tensor bundle. 
For example, for the defining representation $V = \CC^n$ of $\GL_n$, we have $\cV =\hT_n$, 
i.e., the vector fields on the formal disk viewed as the adjoint representation of  $\Vect$. 
Under Gelfand-Kazhdan descent, it produces the tangent bundle ${\rm T}$ on $\Hol_n$.

%\begin{rmk}
%It will be convenient for us to enlarge this category $\VB_n$ by adjoining countable direct sums and direct products. Denote this larger category by $\Hat{\VB}_n$. 
%This enlargement will allow us to describe the vertex algebras in this
%setting of formal geometry.
%\end{rmk}

\subsection{Formal characteristic classes}

\subsubsection{Recollection}

In \cite{atiyah}, Atiyah examined the obstruction --- which now bears his name --- to equipping a holomorphic vector bundle with a holomorphic connection from several perspectives. To start, as he does, we take a very structural approach. He begins by constructing the following sequence of vector bundles (see Theorem 1).

\begin{dfn}
Let $G$ be a complex Lie group. Let $E \to X$ be a holomorphic vector
bundle on a complex manifold and $\cE$ its sheaf of sections. The {\em Atiyah sequence} of $E$ is the
exact sequence holomorphic vector bundles given by
\[
0 \to E \tensor T^* X \to J^1(E) \to E \to 0,
\]
where $J^1(E)$ the bundle of {\em first-order} jets of $E$
The {\em Atiyah class} is the element $\At(E) \in {\rm H}^1(X, \Omega^1_X
\tensor \End_{\cO_X} (\cE))$ associated to the extension above. 
\end{dfn}

\begin{rmk}
Taking linear duals we see tha above short exact sequence is
equivalent to one of the form
\ben
0 \to \End (E) \to {\rm A}(E) \to T X \to 0
\een
where ${\rm A}(E)$ is the so-called {\em Atiyah bundle} associated to $E$. 

We should remark that the sheaf $\cA(E)$ of holomorphic sections of the Atiyah bundle ${\rm A}(E)$ is a Lie algebra by borrowing the Lie bracket on vector fields.
By inspection, the Atiyah sequence of sheaves (by taking sections) is a sequence of Lie algebras; 
 in fact, $\cA(E)$ is a central example of a Lie algebroid, as the quotient map to vector fields $\cT_X$ on $X$ is an anchor map.
\end{rmk}

Atiyah also examined how this sequence relates to the Chern theory of connections.

\begin{prop} 
A {\em holomorphic connection} on $E$ is a splitting of the Atiyah sequence (as holomorphic vector bundles).
\end{prop}

Atiyah's first main result in the paper is the following.

\begin{prop}[Theorem 2, \cite{atiyah}]
A connection exists on $E$ if and only if the Atiyah class $\At(E)$ vanishes.
\end{prop}

He observes immediately after this statement that the construction is
functorial in maps of bundles. Later, he finds a direct connection
between the Atiyah class and the curvature of a smooth connection. A
smooth connections always exists (i.e., the sequence splits as smooth
vector bundles, not necessarily holomorphically), and one is free to
choose a connection such that the local 1-form only has
Dolbeault type $(1,0)$, i.e., is an element in $\Omega^{1,0}(X; \End(E))$. In that case, the $(1,1)$-component
$\Theta^{1,1}$ of the curvature $\Theta$ is a 1-cocycle in the
Dolbeault complex $(\Omega^{1,*}(X ; \End(E)), \overline{\partial})$ for $\End(E)$ and its cohomology class $[\Theta^{1,1}]$ is the Atiyah class $\At(E)$. In consequence, Atiyah deduces the following.

\begin{prop}
For $X$ a compact K\"ahler manifold, the $k$th Chern class $c_k(E)$ of $E$ is given by the cohomology class of $(2\pi i)^{-k} S_k(\At(E))$, 
where $S_k$ is the $k$th elementary symmetric polynomial, and hence only depends on the Atiyah class.
\end{prop}

This assertion follows from the degeneracy of the Hodge-to-de Rham
spectral sequence. More generally, the term $(2\pi i)^{-k}
S_k(\At(E))$ agrees with the image of the $k$th Chern class in the
Hodge cohomology $H^k(X ; \Omega^k_{hol})$.

The functoriality of the Atiyah class means that it makes sense not just on a fixed complex manifold, but also on the larger sites $\Hol_n$ and $\GK_n$. 
We thus immediately obtain from Atiyah the following notion.

\begin{dfn}
For each $V \in \vb(\Hol_n)$, the {\em Atiyah class} $\At(V)$ is the equivalence class of the extension of the tangent bundle $T$ by $\End(V)$ given by the Atiyah sequence.
\end{dfn}

Moreover, we have the following.

\begin{lem}
The cohomology class of $(2\pi i)^{-k} S_k(\At(V))$ provides a section
of the sheaf $H^k(X ; \Omega^k_{hol})$. On any compact K\"ahler manifold, it agrees with $c_k(V)$.
\end{lem}

\subsubsection{The formal Atiyah class}

We now wish to show that Gelfand-Kazhdan descent sends an exact sequence in $\VB_{\hc}$ to an exact sequence in $\vb(\GK_n)$ (and hence in $\vb(\Hol_n)$). 
It will then remain to verify that for each tensor bundle on $\Hol_n$, 
there is an exact sequence over the formal $n$-disk that descends to the Atiyah sequence for that tensor bundle.

We will use the notation $\desc_\GK(\cV)$ to denote the functor $\desc_\GK(-,\cV): \GK_n^\op \to \Pro(\vb)_{flat}$, 
since we want to focus on the sheaf on $\GK_n$ (or $\Hol_n$) defined
by each formal vector bundle~$\cV$. Taking flat sections we get an
$\cO$-module $\sdesc_{\GK}(\cV)$ which is locally free of finite
rank and so determines an object in $\vb(\GK_n)$. 

\begin{lem}
If $$\cA \to \cB \to \cC$$ is an exact sequence in $\vb_{\hc}$, then 
$$\sdesc_\GK(\cA) \to \sdesc_\GK(\cB) \to \sdesc_\GK(\cC)$$ 
is exact in $\vb(\GK_n)$.
\end{lem}

\begin{proof}
A sequence of vector bundles is exact if and only if the associated
sequence of $\cO$-modules is exact (i.e., the sheaves of sections of
the vector bundles). But a sequence of sheaves is exact if and only if
it is exact stalkwise. Observe that there is only one point at which
to compute a stalk in the site $\Hol_n$, since every point $x \in X$
has a small neighborhood isomorphic to a small neighborhood of $0 \in
\CC^n$. As we are working in an analytic setting, the stalk of a
$\cO$-module at a point $x$ injects into the $\infty$-jet at
$x$. Hence, it suffices to verifying the exactness of the sequence of
$\infty$-jets. Hence, we consider the $\infty$-jet at $0 \in \CC^n$ of
the sequence $\desc_\GK(A) \to \desc_\GK(B) \to \desc_\GK(C)$. But
this sequence is simply $A \to B \to C$, which is exact by
hypothesis.
\end{proof}
 %To see that we recover our original sequence, note that \owen{not sure how much to add here}

\begin{cor}
There is a canonical map from $\Ext^1_{\hc}(\cB,\cA)$ to $\Ext^1_{\GK_n}(\sdesc_\GK(\cB), \sdesc_\GK(\cA))$.
\end{cor}

In particular, once we produce the $\hc$-Atiyah sequence for a formal tensor field $\cV$, 
we will have a very local model for the Atiyah class living in $\clie^*(\Vect,\GL_n; \hOmega^1_n \otimes_{\hO_n} \End_{\hO_n}(\cV))$.

%\owen{For $\cV$ a formal tensor field, there is a natural Lie algebra inclusion $\Vect \to \End_\CC(\cV)$ in addition to the Lie algebra inclusion $\End_{\hO_n}(\cV)) \to \End_\CC(\cV)$.
%By direct computation (e.g., picking an $\hO_n$ frame for $\cV$), one can show that the commutator of a vector field with an $\hO_n$-linear endomorphism is again an $\hO_n$-linear endomorphism.
%Hence these subalgebras together span a Lie subalgebra, which we denote $\cA(\cV)$ for the {\em Atiyah algebra} of $\cV$.
%In fact, these Lie algebras sit in an exact sequence
%\[
%\End_{\hO_n}(\cV) \to \cA(\cV) \xto{\sigma} \End_{\hO_n}(\cV) \otimes_{\hO_n}\hT_n.
%\]
%This sequence splits as $\hO_n$-modules (e.g., by picking an $\hO_n$ frame for $\cV$ and coordinates on the formal $n$-disk), 
%but it is also a sequence of formal tensor fields and typically does not split in $\vb(\hD^n)_{\hc}$.}

%\owen{\begin{dfn}
%The {\em $\hc$-Atiyah sequence} of $\cV$ is the short exact sequence
%\[
%\End_{\hO}(\cV) \to \cA(\cV) \to \hT_n
%\]
%in $\vb(\hD^n)_{\hc}$.
%\end{dfn}
%}

\subsubsection{The formal Atiyah sequence} \label{sec: formal atiyah}

Let $\cV$ be a formal vector bundle. 
We will now construct the ``formal'' Atiyah sequence associated to $\cV$.  
First, we need to define the $(\Vect, \GL_n)$-module of {\em first order jets} of $\cV$. 
Let's begin by recalling the construction of jets in ordinary geometry.

If $X$ is a manifold, we have the diagonal embedding $\Delta : X \hookrightarrow X \times X$. 
Correspondingly, there is the ideal sheaf $\cI_\Delta$ on $X \times X$ of functions vanishing along the diagonal. 
Let $X^{(k)}$ be the ringed space $(X, \cO_{X \times X}/\cI_\Delta^k)$ 
describing the $k$th order neighborhood of the diagonal in $X \times X$. 
Let $\Delta^{(k)} : X^{(k)} \to X \times X$ denote the natural map of ringed spaces.
The projections $\pi_1, \pi_2 : X \times X \to X$ compose with $\Delta^{(k)}$ 
to define maps $\pi^{(k)}_1, \pi_2^{(k)} : X^{(k)} \to X$. 
Given an $\cO_X$-module $\cV$, 
``push-and-pull'' along these projections,
\ben
J^k_X(\cV) = (\pi_1^{(k)})_* (\pi_2^{(k)})^* \cV,
\een
defines the $\cO_X$-module of $k$th order jets of~$\cV$.

There is a natural adaptation in the formal case. 
The diagonal map corresponds to an algebra map $\Delta^* : \hO_{2n} \to \hO_n$.
Fix coordinatizations $\hO_n = \CC [[ t_1,\ldots,t_n ]]$ and $\hO_{2n} = \CC [[ t'_1,\ldots,t_n', t_1'', \ldots,t_n'' ]].$ 
Then the map is given by $\Delta^*(t'_i) = \Delta^*(t_i'') = t_i$. 

Let $\Hat{I}_n = \ker(\Delta^*) \subset \hO_{2n}$ be the ideal given by the kernel of $\Delta^*$. 
For each $k$ there is a quotient map
\ben
\Delta^{(k)*}: \hO_{2n} \to \hO_{2n} / \Hat{I}_n^{k+1} ,
\een
The projection maps have the form
\ben
\pi_1^{(k)*}, \pi_2^{(k)*}  : \hO_n \to \hO_{2n} / \Hat{I}_n^{k+1},
\een
which in coordinates are $\pi_1^*(t_i) = t'_i$ and $\pi_2^*(t_i)
=~t''_i$. 

\begin{dfn} 
Let $\cV$ be a formal vector bundle on $\hD^n$.
Consider the $\hO_{2n} / \Hat{I}_n^{k+1}$-module
$\cV \tensor_{\hO_n} \left(\hO_{2n} / \Hat{I}_n^{k+1}\right)$,
where the tensor product uses the $\hO_n$-module structure on the
quotient $\hO_{2n} / \Hat{I}_n^{k+1}$ coming from the map $\pi_2^{(k)*}$. 
We define the {\em $k$th order formal jets of $\cV$}, denoted $J^k(\cV)$, 
as the restriction of this $\hO_{2n}/\Hat{I}_n^{k+1}$-module 
to a $\hO_n$-module using the map $\pi_1^{(k)*} : \hO_n \to \hO_{2n} / \Hat{I}_n^{k+1}$. 
\end{dfn}

\begin{lem} For any $\cV \in \VB_n$ the $k$th order formal jets
  $J^k(\cV)$ is an element of $\VB_n$. 
\end{lem}
\begin{proof}
For $\cV$ in $\VB_n$ there is an induced action of $(\Vect, \GL_n)$ on
the tensor product $\cV \tensor_{\hO_n} \hO_{2n} /
\Hat{I}_{n}^{k+1}$. For fixed $k$ we see that $\hO_{2n} / \Hat{I}_n^{k+1}$ is
finite rank as a $\hO_n$ module. Thus it
is immediate that this module satisfies the conditions of a formal
vector bundle.
\end{proof}

As a $\CC$-linear vector space we have $J^1(\cV) = \cV \oplus (\cV \tensor_{\hO_n} \hOmega^1_n)$. 
For $f \in \hO_n$ and $(v, \beta) \in \cV \oplus (\cV \tensor \hOmega^1_n)$, 
the $\hO_n$-module structure is given by
\ben
f \cdot (v, \beta) = (f v, (f \beta + v \tensor \d f)).
\een 
(This formula is the formal version of Atiyah's description in Section 4 of \cite{atiyah},
where he uses the notation~$\mathcal{D}$.) The following is proved in
exact analogy as in the non-formal case which can also be found in
Section 4 of \cite{atiyah}, for instance. 

\begin{prop}\label{1jet2} 
For any $\cV \in \VB_{\hc}$, the $\hO_n$-module $J^1(\cV)$ has a compatible action of the pair $(\Vect, \GL_n)$ and hence determines an object in $\VB_{\hc}$. 
Moreover, it sits in a short exact sequence of formal vector bundles 
\be\label{formalatiyah1}
\cV \tensor \hOmega^1_n \to J^1 (\cV) \to \cV .
\ee
Finally, the Gelfand-Kazhdan descent of this short exact sequence is isomorphic to the Atiyah sequence
\ben
\sdesc_{\GK}(\cV) \tensor \Omega^1_{hol} \to J^1 \sdesc_{\GK} (\cV) \to \sdesc_{\GK}(\cV) .
\een
In particular, $J^1 \desc_{\GK}(\cV) = \desc_{\GK}(J^1 \cV)$.
\end{prop}

We henceforth call the sequence (\ref{formalatiyah1}) {\em the formal Atiyah sequence} for $\cV$. 

\begin{rmk} 
Note that $J^1(\cV)$ is an element of the category $\VB_n$ but it is {\em not} a formal tensor field. 
That is, it does not come from a linear representation of $\GL_n$ via coinduction. 
\end{rmk}

\begin{rmk} 
A choice of a formal coordinate defines a splitting of the first-order jet sequence as $\hO_n$-modules. 
If we write $\cV = \hO_n \tensor_\CC \cV$, then one defines 
\ben
j^1 : \cV \to J^1 \cV \;\; , \;\; f \tensor_\CC v \mapsto (f \tensor_\CC v, (1 \tensor_\CC v) \tensor_{\cO} \d f) .
\een
It is a map of $\hO_n$-modules, and it splits the obvious projection $J^1(\cV) \to \cV$. 
We stress, however, that it is {\em not} a splitting of $\Vect$-modules. 
We will soon see that this is reflected by the existence of a certain characteristic class in Gelfand-Fuks cohomology. 
\end{rmk}

Note the following corollary, which follows from the identification 
$$\Ext^1(\cV \tensor_{\hO_n} \hOmega_{n}^1, \cV) \cong \clie^1(\Vect,\GL_n; \hOmega^1_n \otimes_{\hO_n} \End_{\hO_n}(\cV))$$ 
and from the observation that an exact sequence in $\vb(\hD^n)$ maps to an exact sequence in $\vb(\GK_n)$.

\begin{cor}
There is a cocycle $\At^\GF(\cV) \in \clie^1(\Vect,\GL_n; \hOmega^1_n \otimes_{\hO_n} \End_{\hO_n}(\cV))$ representing the Atiyah class $\At(\desc_\GK(\cV))$. 
\end{cor}

We call this cocycle the Gelfand-Fuks-Atiyah class of $\cV$ since it
descends to the ordinary Atiyah class for $\desc(\cV)$ as a sheaf of
$\cO$-modules. 

%We call this cocycle the {\em universal Atiyah class} since it descends to the Atiyah class on any $n$-manifold with respect to the map
%\ben
%{\rm H}^1(\Vect, \GL_n ; \hOmega^1_n \tensor \End_{\hO_n}(\cV)) \cong \Ext^1(\cV \tensor \hOmega^1_n, \cV) \to \Ext_{\GK_n}(\desc(\cV) \tensor \Omega^1, \desc(\cV)) .
%\een

%Let us fix a GK-structure $\sigma$ over a complex manifold $X$. 

%\begin{lemma} There is a quasi-isomorphism
%\ben
%\Ext^1_{\cO_X}(\sdesc(\sigma, \cV_1), \sdesc(\sigma, \cV_2)) \simeq \bdesc()
%\een
%\end{lemma}

%For a fixed GK-structure $\sigma$ over a complex manifold $X$ the image of $\At^\GF(\cV)$ under t%he characteristic map
%\ben
%\ch_\sigma : \clie^*(\Vect , \GL_n ; \hOmega^1 \tensor_{\hO_n} \End_{\hO_n}(\cV)) \to \bdesc(\sigma, \\cV) = \dR\left(X ; \desc(\sigma, \cV)\right) \simeq \ch^*(X ; \sdesc(\sigma, \cV))
%\een
%agrees with the ordinary Atiyah class for $\desc(\cV)$ in cohomology.

%\owen{\begin{proof}[Proof of lemma]
%The key is to use the Lie algebra structure on the formal Atiyah sequence for $\cV$. 
%The action of formal vector fields on $\cV$ descends to the action of vector fields on the tensor bundle $\desc_\GK(\cV)$, which is canonical and determined by the Lie derivative.
%Likewise, the action of $\cO$-linear endomorphisms $\End_{\hO_n}(\cV)$ descends to the action of $\cO$-linear endomorphisms $\End_{\cO}(\desc_\GK(\cV))$, which is also canonical.
%Hence, we have a short exact sequence of Lie algebras in sheaves on the site $\GK_n$, 
%and its leftmost and rightmost terms are the same as Atiyah's sequence.
%We need to identify the Lie algebras in the middle of the exact sequences.
%One strategy would be to reinterpret $\cA(\cV)$ as "invariant vector fields on the total space of $\cV$ over $\hD^n$," although that may seem silly.
%\end{proof}}
%\owen{BW suggests the following approach: verify that $\desc_\GK(\Diff^{\leq 1})$ is the appropriate tensor bundle by directly doing sufficiently many examples}
%%\owen{I'd like to say that $$\loc(\Diff^{\leq 1}_\cV) = \Diff^{\leq 1}_{\loc(\cV)}$$ but I'm not sure how to write something rigorous. The crux seems to be showing that this localized Lie algebra, whose avatar on the formal disk acts naturally on $\cV$ as a ``Lie algebroid,'' acts on the localization of $\cV$ in the appropriate way.}
%
%\owen{Vague thoughts: 
%The local action of formal vector fields globalizes to the action of vector fields on a tensor bundle, which is canonical and determined by the Lie derivative.
%Likewise, the local action of $\cO$-linear endomorphisms globalizes to the action of endomorphisms, which is also canonical.
%Hence it will suffice to identify the usual Atiyah algebra, in the global setting, as this descent object. 
%This must be somewhere in the literature.}

\begin{dfn}
The {\em Gelfand-Fuks-Chern character} is the formal sum $\ch^\GF(\cV) = \sum_{k \geq 0} \ch^\GF_k(\cV)$, 
where the $k$th component
\ben
{\rm ch}_k^\GF(\cV) := \frac{1}{(-2 \pi i)^k k!} {\rm Tr}({\At}^\GF(\cV)^k)
\een
lives in $\clie^k(\Vect,\GL_n; \hOmega^k_n)$.
\end{dfn}

It is a direct calculation to see that $\ch^{\GF}_k(\cV)$ is closed for
the differential on formal differential forms, 
i.e., it lifts to an element in $\clie^k(\Vect,\GL_n; \hOmega^k_{n,cl})$.

\subsubsection{An explicit formula}

In this section we provide an explicit description of the Gelfand-Fuks-Atiyah class  
\ben
\At^{\rm GF}(\cV) \in \clie^1(\Vect, \GL_n ; \hOmega^1_n
\tensor_{\hO_n} \End_{\hO}(\cV)) .
\een 
of a formal vector bundle $\cV$. 

By definition, any formal vector bundle has the form $\cV = \hO_n \tensor V$, 
with $V$ a finite-dimensional vector space.
We view $V$ as the ``constant sections'' in $\cV$ by the inclusion $i: v \mapsto 1 \otimes v$.
This map then determines a connection on $\cV$:
we define a $\CC$-linear map $\nabla: \cV \to \hOmega^1_n \otimes_{\hO_n} \cV$
by saying that for any $f \in \hO_n$ and $v \in V$,
\[
\nabla(f v) = \d_{dR}(f) v,
\]
where $\d_{dR} : \hO_n \to \hOmega^1_n$ denote the de Rham
differential on functions. This connection appeared earlier when we
defined the splitting of the jet sequence $j^1 = 1 \oplus \nabla$. 

The connection $\nabla$ determines an element in $\clie^1(\Vect ;
\hOmega^1_n \tensor_{\hO} \End_{\hO}(\cV))$, as follows. Let 
\ben
\rho_{\cV} : \Vect \tensor \cV \to \cV
\een
denote the action of formal vector fields and consider the composition
\ben
\Vect \tensor V \xto{\id \tensor i} \Vect \tensor \cV \xto{\rho_{\cV}} \cV \xto{\nabla} \hOmega^1_n \tensor_{\hO} \cV .
\een 
Since $V$ spans $\cV$ over $\hO_n$, this composite map determines a $\CC$-linear map
\[
\alpha_{\cV,\nabla}: \Vect \to \hOmega^1_n \tensor_{\hO} \End_{\hO}(\cV)
\]
by
\[
\alpha_{\cV,\nabla}(X)(fv) = f \nabla( \rho_\cV(X)(i(v))),
\]
with $f \in \hO_n$ and $v \in V$.

\begin{prop} \label{atiyahprop1} 
Let $\cV$ be a formal vector bundle. 
Then $\alpha_{\cV,\nabla}$ is a representative for the Gelfand-Fuks-Atiyah class~$\At^{\rm GF}(\cV)$. 
\end{prop}

\begin{proof}
We begin by recalling some general facts about the Gelfand-Fuks-Atiyah class as an
extension class of an exact sequence of modules. Viewing $\hO_n$ as functions on the formal $n$-disk, we can ask about the jets of such functions.
A choice of formal coordinates corresponds to an identification $\hO_n \cong \CC[[t_1,\ldots,t_n]]$,
and that choice provides a trivialization of the jet bundles by providing a preferred frame.
This frame identifies, for instance, $J^1$ with $\hO_n \oplus \hOmega^1_n$,
and the1-jet of a formal function $f$ can be understood as~$(f, \d_{dR}f)$.

For a formal vector bundle $\cV = \hO_n \otimes V$, something similar happens after choosing coordinates.
We have $J^1(\cV) \cong \cV \oplus \hOmega^1_n \otimes_{\hO_n} \cV$ and
the 1-jet of an element of $\cV$ can be written as
\ben
\begin{array}{cccc}
j^1 : & \cV & \to & J^1(\cV)   \\
& f v & \mapsto & (f  v, \d_{dR}(f) v ) .
\end{array}
\een 
where $f \in \hO_n$ and $v \in V$. 
The projection onto the second summand is precisely the connection $\nabla$ on $\cV$ 
determined by $\cV = \hO_n \otimes V$, the defining decomposition.

The Gelfand-Fuks-Atiyah class is the failure for this map $\nabla$ to be a map of $\Vect$-modules. 
Indeed, $\nabla$ determines a map of graded vector spaces
\ben
1 \tensor \nabla : \clie^\#(\Vect ; \cV) \to \clie^\#(\Vect ;\hOmega^1_n
\tensor_{\hO} \cV) .
\een
Let $\d_{\cV}$ denote the differential on $\clie^*(\Vect; \cV)$ and
$\d_{\Omega^1 \tensor \cV}$ denote the differential on $\clie^*(\Vect
; \hOmega^1_n \tensor_{\hOmega} \cV)$. The failure for $1 \tensor \nabla$ is precisely the difference
\be\label{difference}
(1 \tensor \nabla) \circ \d_{\cV} - \d_{\Omega^1 \tensor \cV} \circ (1 \tensor
\nabla).
\ee
This difference is $\clie^\#(\Vect)$ linear and can hence be
thought of as a cocycle of degree one in $\clie^*(\Vect ; \hOmega^1
\tensor_{\hO} \End_{\hO} (\cV))$. This is the representative for the Atiyah
class. 

We proceed to compute this difference. The differential $\d_{\cV}$ splits as $\d_{\Vect}
\tensor 1_\cV
+ \d'$ where $\d_{\Vect}$ is the differential on the complex
$\clie^*(\Vect)$ and $\d'$ encodes the action of $\Vect$ on
$\cV$. Likewise, the differential $\d_{\Omega^1 \tensor \cV}$ splits
as $\d_{\Vect} \tensor 1_{\Omega^1 \tensor \cV} + \d_{\Omega^1}
\tensor 1_V + 1_{\Omega^1} \tensor \d '$ where $\d_{\Omega^1}$ is the differential on the complex $\clie^*(\Vect ;
\hOmega^1_n)$. 

The de Rham differential clearly commutes with the
action of vector fields so that $(1 \tensor \d_{dR}) \circ
(\d_{\cO}\tensor 1) = (\d_\Vect + \d_{\Omega^1})\circ(1 \tensor
\d_{dR})$ so that the the difference in (\ref{difference}) reduces to 
\ben
(1 \tensor \nabla) \circ \d' - (1_{\Omega^1} \tensor \d') \circ (1
\tensor \nabla) .
\een
By definition $\d'$ is the piece of the Chevalley-Eilenberg
differential that encodes the action of $\Vect$ on $\cV$, so if we
evaluate on an element of the form $1 \in v \in \clie^0(\Vect ; V)
\subset \clie^0(\Vect ; \cV)$ the only term that survives is the GF 1-cocycle
\ben
X \mapsto \nabla \d'(1 \tensor v)(X) = \nabla (\rho_\cV(X) (v)) .
\een
as desired. 
\end{proof}

\begin{cor} 
On the formal vector bundle $\hT_n$ encoding formal vector fields, 
fix the $\hO_n$-basis by $\{\partial_j\}$ and the $\hO_n$-dual basis of one-forms by $\{\d t^j\}$. 
The explicit representative for the Atiyah class is given by the Gelfand-Fuks 1-cocycle 
\ben
f^i \partial_i\mapsto - \d_{dR} (\partial_j f^i) (\d t^j
\tensor \partial_i)
\een
taking values in $\hOmega^1_n \tensor_{\hO_n} \End_{\hO}(\hT_n)$.
\end{cor}

\begin{proof} 
We must compute the action of vector fields on $\hO_n$-basis elements of $\hT_n$. 
We fix formal coordinates $\{t_j\}$ and let $\{\partial_j\}$ be the associated constant formal vector fields. 
Then the structure map is given by the Lie derivative $\rho_{\hT} (f^i \partial_i , \partial_j ) = - \partial_j f^i$. 
The formula for the cocycle follows from the Proposition. 
\end{proof}
 
We can use this result to explicitly compute the cocycles representing the Gelfand-Kazhdan Chern characters. 
For instance, we have the following formulas that will be useful in later sections.

\def\Jac{{\rm Jac}}

\begin{cor}
The $k$th component $\ch_k^{\rm GF}(\hT_n)$ of the universal Chern character of the formal tangent bundle is the cocycle
\ben
\frac{1}{(-2\pi i)^k k!} {\rm Tr}({\rm At}^\GF(\hT_n)^{\wedge k}): (f_1^i \partial_i, \ldots, f_k^i \partial_i) \mapsto \frac{1}{(-2\pi i)^k k!} {\rm Tr} \left(\d_{dR}(\Jac(f_1)) \wedge \cdots \wedge \d_{dR}(\Jac(f_k))\right)
\een 
in $\clie^k(\Vect,\GL_n; \hOmega_n^k)$.
Here, $\Jac(f)$ is the $n \times n$ matrix valued in $\hO_n$ with $(ij)$ entry given by $\partial_j f_i$.  
As the de Rham differential $\d_{dR} : \hOmega^{k-1}_n \to \hOmega^{k}_n$ is $\Vect$-equivariant, 
there is an element $\alpha_{k-1}$ in $\clie^k(\Vect,\GL_n; \hOmega_n^{k-1})$ such that
\[
\ch_{k}^{\rm GF}(\hT_n) = \d_{dR} \alpha_{k-1}
\]
Explicitly:
\[
\alpha_k : (f_1^i \partial_i, \ldots, f_k^i \partial_i) \mapsto \frac{1}{(-2\pi i)^k k!}  {\rm Tr} \left(\Jac(f_1) \wedge \d_{dR} (\Jac(f_2)) \wedge \cdots \wedge \d_{dR}(\Jac(f_k))\right) .
\]
\end{cor}

\subsection{A family of extended pairs}

We will be most interested in the cocycles $\ch_k(\cV)$ for $k \geq 2$. 
When $k=2$ we obtain a $2$-cocycle with values in $\hOmega^2_{n,cl}$, $\ch_2(\cV) \in \clie(\Vect , \GL_n ; \hOmega^2_{n,cl})$. 
This $2$-cocycle $\ch_2^{\GF}(\cV)$ determines an abelian extension Lie algebras of $\Vect$ by $\hOmega^2_{n,cl}$
\ben
0 \to \hOmega^2_{n,cl} \to \Tilde{\rm W}_{n, \cV} \to \Vect \to 0 .
\een
When $\cV = \hT_n$, denote this extension by $\Tilde{\rm W}_{n, \cV} = \Tilde{\rm W}_{n,1}$. (The notation will become clearer momentarily)

We have already discussed the pair $(\Vect, \GL_n)$. We will need that
the above extension of Lie algebras fits in to a Harish-Chandra pair
as well. The action of $\GL_n$ extends to an action on $\TVect$ where
we declare the action of $\GL_n$ on closed two-forms to be the natural
one via linear formal automorphisms.

\begin{lem} \label{lem d=1 pair}
The pair $(\TVect, \GL_n)$ form a Harish-Chandra pair and fits into an extension of pairs
\ben
0 \to \hOmega^2_{n,cl} \to (\TVect, \GL_n) \to (\Vect, \GL_n) \to 0
\een
which is determined by the cocycle $\ch_2^{\GF}(\hT_n)$. 
\end{lem}

One might be worried as to why there is only a non-trivial extension
of the Lie algebra in the pair. The choice of a coordinate determines
an embedding of linear automorphisms $\GL_n$ into formal automorphisms
$\Aut_n$. The extension of formal automorphisms $\Aut_n$ defined by
the group two-cocycle $\ch_2^\GF(\hT_n)$ is trivial when restricted to
$\GL_n$ so that it does not get extended.

\subsubsection{An $L_\infty$ extension}

For $k > 2$, it will be useful to think of $\ch_k(\cV)$ as defining a similar type of extension.
For this to make sense, we observe the following phenomena for higher cocycles. 
Suppose $M$ is a module for a Lie algebra $\fg$, and suppose $c \in \clie^k(\fg ; M)$ is a cocycle $\d_{CE} c = 0$. 
Then, $c$ determines an abelian extension of $L_{\infty}$-{\em algebras}
\ben
0 \to M[k-2] \to \Tilde{\fg} \to \fg
\een
As a graded vector space $\Tilde{\fg}$ is $\fg \oplus M[k-2]$ (so that $M$ is placed in degree $2-k$). 
The $L_\infty$ structure on $\Tilde{\fg}$ is defined by, for $x,y,x_1,\ldots,x_k \in \fg$, $m \in M$:
\begin{align*}
\ell_2(x, y+m) & = [x,y] + x \cdot m \\
\ell_k(x_1,\ldots,x_k) = c(x_1,\ldots,x_k) .
\end{align*}
Here, $x \cdot m \in M$ uses the module structure. 

Thus, for any formal vector bundle $\cV$, $\ch_k(\cV)$ determines an abelian $L_\infty$ extension of $\Vect$ by the abelian Lie algebra $\hOmega^{k}_{n,cl}$. 
The case $\cV= \hT_n$ will be especially relevant for us. 



\begin{dfn} 
Denote by $\TVectd$ the $L_\infty$ extension of $\Vect$ by the module $\hOmega^{d+1}_{n,cl}[d-1]$:
\ben
0 \to \hOmega^{d+1}_{n,cl}[d-1] \to \TVectd \to \Vect \to 0
\een
determined by the $(d+1)$-cocycle $\ch_{d+1}(\hT_n) \in \clie^{d+1}(\Vect , \GL_n ; \hOmega^{d+1}_{n,cl})$. 
\end{dfn}

We would like to have an an analog of Lemma \ref{lem d=1 pair} for $\TVectd$ and the group $\GL_n$. 
To make this possible, we need to slightly enlarge our category of Harish-Chandra pairs to include the data of an $L_\infty$ algebra, instead of an ordinary Lie algebra. 

\subsubsection{$L_\infty$ pairs}

The concept of an ordinary Harish-Chandra pair involves a Lie group $K$, a Lie algebra $\fg$ with an action by $K$, together with an embedding of Lie algebras $\Lie(K) \to \fg$. 
There is a natural way to relax this to include $L_\infty$ algebras.

\begin{dfn} An $L_\infty$ Harish-Chandra pair is a pair $(\fg,K)$ where $\fg$ is an $L_\infty$ algebra and $K$ is a Lie group together with
\begin{enumerate}
\item a linear action of $K$ on $\fg$, $\rho_K : K \to {\rm GL}(\fg)$;
\item a map of $L_\infty$ algebras $i : \Lie(K) \rightsquigarrow \fg$;
\end{enumerate}
such that $i$ is compatible with the action $\rho_K$ and the adjoint action of $K$ on $\Lie(K)$.
\end{dfn}

\begin{rmk}
A morphism of $L_\infty$ algebras $f : \fh \rightsquigarrow \fg$ is, by definition, a map of the underlying Chevalley-Eilenberg complexes
\ben
\clieu_*(f) : \clieu(\fh) \to \clieu(\fg)
\een 
as cocoummutative coalgebras. 
Now, $\clieu_*(\fg)$, being a free cocoummtative coalgebra, this map is determined by a sequence of maps $f_n : \Sym^n(\fh[1]) \to \fg[1]$ satisfying certain compatibility conditions. 
\end{rmk}

\begin{rmk} 
This is certainly not the most general definition one can imagine for a homotopy enhancement of a Harish-Chandra pair. 
For instance, we have required that $K$ acts on $\fg$ in a rather strict way. 
It turns out that this will be enough for our purposes.
\end{rmk}

The condition that $i : \Lie(K) \to \fg$ be compatible with $\rho_K$ can be stated as follows. 
The $L_\infty$ map $i : \Lie(K) \rightsquigarrow \fg$ is uniquely determined by a sequence of maps $i_n : \Sym^n(\Lie(K)[1]) \to \fg$, for each $n \geq 1$. 
We require that for each $n \geq 1$, all $A \in K$, and $x_1,\ldots, x_n \in \Lie(K)$ that
\ben
\rho_K(A) \cdot i_n(x_1,\ldots, x_n) = i_n \left(\left({\rm Ad}(A) \cdot x_{1}\right) \cdots  \left({\rm Ad}(A) \cdot x_{n}\right)\right) .
\een 
Here ${\rm Ad}(A)$ denotes the adjoint action of $A \in K$ on $\Lie(K)$. 

\begin{lem} The for any $d \geq 1$ the pair $(\TVectd, \GL_n)$ has the structure of an $L_\infty$ Harish-Chandra pair.
\end{lem}
\begin{proof}
The proof is similar to the case $d=1$. 
The linear action of $\GL_n$ on $\TVectd$ comes from the natural one on $\Vect$ and $\hOmega^{d+1}_{n,cl}$. 
Now, note that we have an $\GL_n$-equivariant extension
\ben
\xymatrix{
& \TVectd \ar[d] \\
\gl_n \ar[r] \ar@{.>}[ur] & \Vect 
}
\een
since the cocycle $\ch_{d+1}(\hT_n)$ vanishes when one of the inputs lies in $\gl_n$. 
\end{proof}

In the next section we will see how the theory of descent for $(\Vect, \GL_n)$ can be extended to the pair $(\TVectd, \GL_n)$ provided a trivialization of the $(d+1)$st component of the Chern character is trivialized. 
This will be our main application of this extended pair. 

\section{Descent for extended pairs}

\subsection{General theory of descent for $L_\infty$ pairs}

In this section we set up the general theory of descent for $L_\infty$ pairs $(\fg,K)$.
Recall, this means that $K$ is still and ordinary Lie group, but $\fg$ is an $L_\infty$ algebra. 

Let $X$ be a fixed manifold, for which we are defining descent over. 
The starting point is the theory of bundles over $X$ for the pair $(\fg,K)$. 
In the usual context of Harish-Chandra pairs (where $\fg$ is an ordinary Lie algebra), this means that we have a principal $K$-bundle $P \to X$ equipped with a $K$-equivariant one-form valued in $\fg$, $\omega \in \Omega^1(P, \fg)$ satisfying the flatness condition
\ben
\d \omega + \frac{1}{2} [\omega, \omega] = 0 .
\een 
In other words, $\omega$ is a Maurer-Cartan element of the dg Lie algebra $\Omega^*(P) \tensor \fg$ that is equivariant for the action of $K$ on $P$ and $\fg$. 

The theory of Maurer-Cartan forms works just as well in the $L_\infty$ case. 
First, note that the category of $L_\infty$ algebras is tensored over commutative dg algebras. 
In other words, if $\fg$ is an $L_\infty$ algebra and $A$ a commutative dg algebra, there is the natural structure of an $L_\infty$ algebra on $A \tensor \fg$. 
The $n$-ary brackets are of the form 
\ben
\ell_n^{A \tensor \fg}(a_1 \tensor x_1, \ldots, a_n \tensor x_n) = (a_1 \cdots a_n) \ell^\fg_n(x_1,\ldots, x_n)
\een
where $\ell_n^\fg$ is the $n$-ary bracket on $\fg$, and where we have used the commutative algebra structure on $A$. 

\begin{dfn} 
Let $(\fg, K)$ be an $L_\infty$ Harish-Chandra pair. 
A principal $(\fg,K)$-bundle on $X$ is the data:
\begin{enumerate}
\item a principal $K$-bundle $P \to X$;
\item a $K$-invariant element 
\ben
\omega \in \Omega^*(P) \tensor \fg
\een
of total degree $+1$;
\end{enumerate}
such that 
\begin{enumerate}
\item for all $a_1,\ldots,a_n \in \Lie(K)$ we have $\omega(\xi_{a_1}, \cdots, \xi_{a_n}) = i(a_1,\ldots, a_n)$ where $\xi_{a_i}$ is the vertical vector field on $P$ determined by $a_i$, and $i : \Lie(K) \rightarrow \fg$ is the $L_\infty$ morphism determining the Harish-Chandra pair;
\item $\omega$ is a Maurer-Cartan element of the $L_\infty$ algebra $\Omega^*(P) \tensor \fg$. In other words, 
\ben
\d \omega + \sum_{n \geq 1} \ell_n(\omega,\ldots,\omega) = 0
\een
where $\{\ell_n\}$ are the structure maps for $\fg$. 
\end{enumerate}
\end{dfn}  

To define descent, we need an appropriate theory of modules for an $L_\infty$ pair $(\fg,K)$. 

\begin{dfn} 
\label{dfn ss HC mod}
A {\em semi-strict Harish-Chandra module} for the $L_\infty$ pair $(\fg,K)$ is a dg vector space $(V,\d_V)$ equipped with
\begin{itemize}
\item[(i)] a strict group action $\rho^K_V$ of $K$, meaning a group map 
\ben
\rho^K_{V^d} : K \to \GL(V^d)
\een 
for each degree $d$ such that the product map $\prod_d \rho^K_{V^d}: K \to \prod_d \GL(V^d)$ commutes with the differential~$\d_V$;
\item[(ii)] an $L_\infty$-action of $\fg$ on $V$, i.e., a map of $L_\infty$-algebras $\rho^\fg_V : \fg \rightsquigarrow \End(V)$,
such that the composite 
$$\cliels(\rho^\fg_V) \circ \cliel_*(i): \cliels(\Lie(K)) \to \cliels(\End(V))$$
equals the map 
$$\cliel_*(D\rho^K_V): \cliels(\Lie(K)) \to \cliels(\End(V)).$$ 
\end{itemize}
Here $D \rho^K_V : \Lie(K) \to \End(V)$ is the differential of the strict $K$-action and $i: \Lie(K) \rightsquigarrow \fg$ is part of the data of the Harish-Chandra pair $(\fg,K)$.
\end{dfn}

\subsubsection{Basic forms}

Before the construction of descent, we recall a basic object in equivariant differential geometry.

Let $V$ be a finite-dimensional $K$-representation. 
Denote by $\ul{V}$ the trivial vector bundle on $P$ with fiber $V$. 
Sections of this bundle $\Gamma_P(V)$ have the structure of a $K$-representation by
\ben
A \cdot (f\tensor v) := (A \cdot f) \tensor (A \cdot v) \;\; , \;\; A \in K, \; f \in \cO(P)\; , v \in V .
\een
Every $K$-invariant section $f : P \to \ul{V}$ induces a section $s(f): X \to V_X$,
where the value of $s(f)$ at $x \in X$ is the $K$-equivalence class $[(p,f(p)]$, with $p \in \pi^{-1}(x) \cong K$.
That is, there is a natural map 
\ben
s : \Gamma_P(\ul{V})^K \to \Gamma_X(V_X) 
\een
and it is an isomorphism of $\cO(X)$-modules. A $K$-invariant section $f$ of $\ul{V} \to P$ also satisfies the infinitesimal version of invariance: 
\ben
(Y \cdot f)\tensor v + f \tensor {\rm Lie}(\rho)(Y) \cdot v = 0 
\een
for any $Y \in {\rm Lie}(K)$.

There is a similiar statement for differential forms with values in the bundle $V_X$. Let $\Omega^k(P ; \ul{V}) = \Omega^k(P) \tensor V$ denote the space of $k$-forms on $P$ with values in the trivial bundle $\ul{V}$. Given $\alpha \in \Omega^1(X ; V_X)$, its pull-back along the projection $\pi: P \to X$ is annihilated by any vertical vector field on $P$. In general, if $\alpha \in \Omega^k(X; V_X)$, then $i_Y(\pi^*\alpha) = 0$ for all $Y \in {\rm Lie}(K)$.

\begin{dfn} A $k$-form $\alpha \in \Omega^k(P; \ul{V})$ is called {\em basic} if 
\begin{enumerate}
\item it is $K$-invariant: $L_Y \alpha + \rho(Y) \cdot \alpha = 0 $ for all $Y \in {\rm Lie}(K)$ and
\item  it vanishes on vertical vector fields: $i_Y \alpha = 0$ for all $Y \in {\rm Lie}(K)$. 
\end{enumerate}
\end{dfn}

Denote the subspace of basic $k$-forms by $\Omega^k(P; \ul{V})_{bas}$. Just as with sections, there is a natural isomorphism
\ben
s : \Omega^k(P; \ul{V})_{bas} \xto{\cong} \Omega^k(X; V_X) 
\een
between basic $k$-forms and $k$-forms on $X$ with values in the associated bundle.
In fact, $\Omega^{\#}(P; \ul{V})_{bas}$ forms a graded subalgebra of $\Omega^{\#}(P; \ul{V})$ and the isomorphism $s$ extends to an isomorphism of graded algebras $\Omega^{\#}(P; \ul{V})_{bas} \cong \Omega^{\#}(X; V_X)$.

It is manifest that this construction of basic forms is natural in maps of $(\fg,K)$-bundles: basic forms pull back to basic forms along maps of bundles.

\subsubsection{}

Starting with the data:
\begin{enumerate}
\item an $L_\infty$ Harish-Chandra pair $(\fg,K)$;
\item a principal $(\fg,K)$ bundle $(P \to X, \omega)$;
\item a semi-strict $(\fg,K)$-module $V$;
\end{enumerate}
we are now ready to define descent along $X$. 
It is constructed in the following steps.

\begin{enumerate}
\item Using the linear action of $K$ on $V$ we define the associated vector bundle
\ben
V_X = P \times^{K} V
\een 
on $X$. Note that the differential forms on $X$ with values in $V_X$, $\Omega^*(X ; V_X)$, is isomorphic, as a dg $\Omega^*(X)$-module, to the complex of basic forms
\ben
\Omega^*(P ; \ul{V})_{bas} \subset \Omega^*(P ; \ul{V}) .
\een 
\item The Maurer-Cartan element $\omega \in \Omega^*(P) \tensor \fg$ allows us to deform the differential on $\Omega^{*}(P ; \ul{V}) = \Omega^*(P) \tensor V$ by the following transfer of Maurer-Cartan elements. 
By the usual yoga of Koszul duality, the Maurer-Cartan element $\omega \in \Omega^*(P) \tensor \fg$ is equivalent to the data of a map of commutative dg algebras
\ben
\omega^* : \clie^*(\fg) \to \Omega^*(P) .
\een 
We can then use the $L_\infty$ module structure map $\rho_V : \fg \rightsquigarrow \End(V)$ to  form the composition
\ben
\xymatrix{
\clie^*(\End(V)) \ar[r]^-{\clie^*(\rho_V^\fg)} & \clie^*(\fg) \ar[r]^-{\omega^*} & \Omega^*(P) .
}
\een
This, in turn, corresponds to a Maurer-Cartan element 
\ben
\omega_V \in \Omega^*(P) \tensor \End(V) .
\een 
We use this element to deform the differential on $\Omega^*(P , \ul{V}) = \Omega^*(P) \tensor V$ via
\ben
\left(\Omega^*(P) \tensor V, \d + \omega_V \right) .
\een
Here, $\d = \d_{dR} + \d_V$ where $\d_{dR}$ is the de Rham differential on $P$ and $\d_V$ is the internal differential to $V$. 
We can think of $\nabla^V := \d + \omega_V$ as a flat ``super-connection" on the trivial bundle $P \times V \to P$. 
This means that $\omega_V$ may contain higher differential forms, not just one-forms. 
Tracing through the above construction, we see that $\omega_V$ actually preserves the subspace of basic forms, so it that $\nabla^V$ descends to a flat super-connection on the vector bundle $V_X$ over $X$. 
In other words we obtain the $\Omega^*(X)$-module
\begin{align*}
\bdesc \left((P \to X, \omega), V\right) & :=  \left(\Omega^*(P , \ul{V})_{bas} , \d + \omega_V\right) \\ & = \left(\Omega^*(X , V_X), \nabla^V\right) . 
\end{align*}

\end{enumerate}

\begin{dfn} 
We will denote the vector bundle $V_X$ equipped with its flat superconnection $\nabla^V$ obtained in this way by $\desc((P\to X, \omega), V)$. 
Its associated de Rham complex is denoted $\bdesc((P \to X, \omega), V)$. 
\end{dfn}
 
\begin{rmk} 
This construction of descent enjoys a number of nice functorial properties. \brian{..finish}.
\end{rmk}

\subsection{The flat connection from the extended pair}


\end{document}
